(this.webpackJsonpnewmedia=this.webpackJsonpnewmedia||[]).push([[0],{19:function(e,t,n){},39:function(e,t,n){e.exports=n(66)},58:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),i=n(36),r=n.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=n(16),c=n(4),l=n(5),u=n(9),d=n(7),h=n(6);function v(e,t){f("\u2705"+e,t)}function m(e,t){f("\ud83d\udea7"+e,t)}function f(e,t){console.log(e)}var p=n(31),y=n.n(p),w={apiKey:"AIzaSyB3HvkoiovcDgD5BuCP68T-xE5aIg1mwtE",authDomain:"newmedia-420.firebaseapp.com",databaseURL:"https://newmedia-420.firebaseio.com",projectId:"newmedia-420",messagingSenderId:"724819260757",appId:"1:724819260757:web:63789e8f7eb475b8876bdc"};y.a.initializeApp(w);var g=y.a.database(),b="NEWKEY",x="TESTDB";function E(e){x=e}function S(e){return e!==b&&"NEWKEY"!==b}function M(e){var t=g.ref(x+"/users/").push(),n=t.key;return b=n,z({x:0,y:0,z:0}),v("Initialized.. addedmyself to DB",[n]),t.onDisconnect().remove(),t,b}function z(e){if("NEWUSER"!==b){var t={x:e.x,y:e.y,z:e.z},n={};n[x+"/users/"+b+"/pos"]=t,g.ref().update(n)}}function O(e,t){if("NEWUSER"!==b){var n={value:t},a={};a[x+"/users/"+b+"/"+e]=n,g.ref().update(a)}}function T(e,t,n,a){Object.keys(t).forEach((function(o){if("pos"===o){var i=t.pos;n(e,i.x,i.y,i.z)}else if(a[o]){var r=t[o].value;(0,a[o])(e,r)}}))}function C(e){g.ref(x+"/users").child(e).remove()}function k(e,t,n,a){var o=g.ref(x+"/users");o.once("value",(function(t){v("Reading NPC values from DB",[t]),t.forEach((function(t){var o=t.key;S(o)&&e(o),T(o,t.val(),n,a)}))})),o.on("child_added",(function(t){var n=t.key;S(n)&&(v("A new NPC has joined the room",[n]),e(n))})),o.on("child_removed",(function(e){var n=e.key;t(n),v("An NPC has left the room",[n])})),o.on("child_changed",(function(e){var t=e.key;S(t)&&T(t,e.val(),n,a)}))}function N(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=g.ref(x+"/"+e);a.on("value",(function(e){if(e.val()){var n=e.val().value;void 0!=n&&t(n)}})),n&&P(e)}function A(e,t){var n={value:t},a={};a[x+"/"+e]=n,g.ref().update(a)}function P(e){var t,n;g.ref(x+"/").once("value",(function(a){var o=a.val(),i=o[e];if(i&&!1!==(t=i.value)&&void 0!==t){var r=o.users;n=Object.keys(r),v("User key heartbeat check for "+e,[t,n]),t in n||A(e,!1)}})),setTimeout(P,5e3)}var D=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).addNewUser=function(e){var t=a.state.userList;t[e]={left:50,top:50},a.setState({userList:t})},a.removeUser=function(e){var t=a.state.userList;t[e]&&delete t[e],a.setState({userList:t})},a.renderUsers=function(){var e=[],t=a.state.userList;return Object.keys(t).forEach((function(n){var a=t[n];e.push(o.a.createElement("div",{style:{top:a.top+"%",left:a.left+"%"},key:n}," "))})),e},a.moveCursor=function(e,t,n){var o=a.state.userList;if(o[e]&&e!==a.myKey){var i={left:t,top:n};o[e]=i,a.setState({userList:o})}},a.handleMouseMove=function(e){var t=100*e.clientX/window.innerWidth,n=100*e.clientY/window.innerHeight;z({x:t,y:n,z:0}),a.moveCursor(a.myKey,t,n);var o=a.state.userList,i={left:t,top:n};o[a.myKey]=i,a.setState({userList:o})},a.state={userList:{}},a.myKey="NEWKEY",a.DBCONST="home",a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){E(this.DBCONST),this.myKey=M(),this.addNewUser(this.myKey),k(this.addNewUser,this.removeUser,this.moveCursor)}},{key:"componentWillUnmount",value:function(){C(this.myKey)}},{key:"render",value:function(){return o.a.createElement("div",{style:{cursor:"none"}},o.a.createElement("div",{id:"users"},this.renderUsers()),o.a.createElement("div",{className:"container",onMouseMove:this.handleMouseMove},o.a.createElement("div",{className:"header",style:{padding:"24px"}}),o.a.createElement(c.c,null,o.a.createElement("ul",null,o.a.createElement("li",{style:{top:"20%",left:"30%"}},o.a.createElement(s.b,{to:"/grass"}," movement ")),o.a.createElement("li",{style:{top:"15%",left:"65%"}},o.a.createElement(s.b,{to:"/sun"}," time ")),o.a.createElement("li",{style:{top:"35%",left:"65%"}},o.a.createElement(s.b,{to:"/chair"}," ownership ")),o.a.createElement("li",{style:{top:"65%",left:"35%"}},o.a.createElement(s.b,{to:"/light"}," visibility ")),o.a.createElement("li",{style:{top:"85%",left:"15%"}},o.a.createElement(s.b,{to:"/trash"}," responsibility ")),o.a.createElement("li",{style:{top:"-24px",left:"90%"}},o.a.createElement(s.b,{to:"/about"}," describe this ")),o.a.createElement("li",{style:{top:"60%",left:"60%"}},o.a.createElement(s.b,{to:"/smile"}," your happiness "))))),o.a.createElement("div",{id:"footer"},o.a.createElement("div",{className:"left"},"an invitation to perform"),o.a.createElement("div",{className:"right"},"move/click")))}}]),n}(o.a.Component);n(19),n(58);function H(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"));var t=.01*window.innerWidth;document.documentElement.style.setProperty("--vw","".concat(t,"px")),window.addEventListener("resize",(function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"));var t=.01*window.innerWidth;document.documentElement.style.setProperty("--vw","".concat(t,"px"))}))}function L(e){e&&function(){var e=20,t=50,n=!1;function a(a,o){n&&(e=Math.round(20*a/window.innerWidth*255),t=Math.round(20*o/window.innerHeight*255))}(function n(){var a=document.documentElement;a.style.setProperty("--FGFill","hsl("+e+",100%,50%)"),a.style.setProperty("--BGFill","hsl("+t+",100%,50%)"),requestAnimationFrame(n)})(),document.addEventListener("mousemove",(function(e){return a(e.clientX,e.clientY)})),document.addEventListener("mousedown",(function(){return n=!0})),document.addEventListener("mouseup",(function(){return n=!1})),document.addEventListener("touchmove",(function(e){return a(e.touches[0].clientX,e.touches[0].clientY)})),document.addEventListener("touchend",(function(){return n=!1})),document.addEventListener("touchstart",(function(e){e.touches.length>1||(n=!0)}))}()}function j(){return!document["undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0]}H();var I,R,B,W,F,U,_,J=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).changeLayout=function(){var e="row"===a.state.alignment?"col":"row";a.setState({alignment:e})},a.contentRef=o.a.createRef(),a.state={alignment:"row"},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;!0&&H(),L(!0),document.addEventListener("keypress",(function(t){"Space"===t.code&&e.changeLayout()}))}},{key:"render",value:function(){return o.a.createElement("div",{id:"smileyGrid-root",className:"flex-container border "+this.state.alignment},o.a.createElement(V,{kids:"1",ref:this.contentRef})," ")}}]),n}(o.a.Component),V=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).splitMe=function(e){e.stopPropagation();var t=parseInt(a.state.numChildren)+1+Math.floor(4*Math.random());a.setState({numChildren:t})},a.getChildren=function(){if(1==a.state.numChildren)return o.a.createElement(G,null);for(var e=[],t=0;t<a.state.numChildren;t++)e.push(o.a.createElement(n,{key:t,kids:1}));return e},a.state={numChildren:a.props.kids},a}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"flex-container flex-child border",onClick:function(t){return e.splitMe(t)}},this.getChildren()," ")}}]),n}(o.a.Component),G=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"flex-content border face",style:{borderRadius:Math.floor(40*Math.random())+10+"%"}},o.a.createElement("div",{className:"smile"}," ")," ")}}]),n}(o.a.Component),K=n(25),Y=n(0),q=(n(17),n(24)),Q=new Y.l;function X(){F=document.querySelector(".container"),W=[F.clientWidth,F.clientHeight],Q.start(),(B=new Y.Mb({alpha:!0,antialias:!0})).physicallyCorrectLights=!1,B.setSize(W[0],W[1]),F.appendChild(B.domElement),R=new Y.tb,I=new Y.eb(45,W[0]/W[1],.1,1e3),window.addEventListener("resize",ze,!1),ne(),oe(),function(){var e=new Y.a(16777215,.9);R.add(e);var t=ae(.4,.4,0);(Z=new Y.n(16718304,.2)).position.set(t.x,t.y,t.z),Z.castShadow=!0,R.add(Z)}(),ee||(ee=ue(),R.add(ee),Me(0,0)),function(){var e=new q.a;e.load("/assets/chair/Chair.gltf",(function(e){($=e.scene).traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.geometry)})),re(),R.add($)}))}(),Oe()}var Z,$,ee,te=new Y.Jb(15,15,25);function ne(){te.y=te.x*(W[1]/W[0]),te.z=Math.max(te.x,te.y);var e=new Y.f(te.x,te.y,te.z),t=new Y.Fb,n=(t.load("/assets/chair/wallpaper.png"),t.load("/assets/chair/room/wallpaper.png"));n.wrapS=Y.sb,n.wrapT=Y.sb,n.repeat.set(5,5);var a=t.load("/assets/chair/room/herringbone.jpg");a.wrapS=Y.sb,a.wrapT=Y.sb,a.repeat.set(2,2);var o=[new Y.Q({map:n,side:Y.c}),new Y.Q({map:n,side:Y.c}),new Y.Q({map:n,side:Y.c}),new Y.W({map:a,side:Y.c,receiveShadow:!0}),new Y.W({map:n,side:Y.c,receiveShadow:!0}),new Y.Q({map:n,side:Y.c})];(_=new Y.P(e,o)).receiveShadow=!0,R.add(_)}function ae(e,t,n){return new Y.Jb(e*te.x,t*te.y,n*te.z)}function oe(){var e=ae(0,.4,-.9);I.position.set(e.x,e.y,e.z);var t=ae(0,-.1,0);I.lookAt(t)}function ie(){$&&re()}function re(){var e=ae(.3,.4,.15),t=ae(0,-.5,0),n=(new Y.e).setFromObject($),a=n.getCenter(new Y.Jb),o=n.getSize(new Y.Jb),i=o.y,r=e.y;$.scale.multiplyScalar(r/i),n.setFromObject($),n.getCenter(a),n.getSize(o),$.position.copy(a).multiplyScalar(-1),$.rotation.y=Math.PI,$.position.set(t.x,t.y,t.z)}function se(e,t){if(!$)return!1;var n=(new Y.e).setFromObject($),a=new Y.e,o=e.clone();return o.position.set(t.x,t.y,t.z),a.setFromObject(o),n.intersectsBox(a)}var ce={};function le(){return new Y.Q({color:0})}function ue(){var e=new Y.cb,t=me();e.add(t);var n=ae(.05,.02,.005),a=new Y.yb(n.z,32,32),o=le(),i=new Y.P(a,o);return i.position.set(0,-n.y,0),e.add(i),e}var de=["chair plz","chair?","chaaair?","can i chair","just once, chair","lonely w/o chair"];function he(){return de[Math.floor(Math.random()*de.length)]}function ve(e,t){var n;if("me"===e)n=ee;else{if(!ce[e])return void m(e+"doesnt exist, cant change text",[ce]);n=ce[e]}n.traverse((function(e){if(e.isSprite){var n=e.material.map.image,a=n.getContext("2d");console.log("*********"),console.log(a),a.clearRect(0,0,n.width,n.height),a.fillText(t,2,2),e.material.needsUpdate=!0,e.material.map.needsUpdate=!0}}))}function me(){var e=function(e,t){var n=document.createElement("canvas").getContext("2d"),a="".concat(e,"px monospace");n.font=a;var o=n.measureText(t).width+4,i=e+4;return n.canvas.width=o,n.canvas.height=i,n.font=a,n.textBaseline="top",n.fillStyle="black",n.fillText(t,2,2),n.canvas}(12,"id like the chair"),t=new Y.j(e);t.minFilter=Y.G,t.wrapS=Y.k,t.wrapT=Y.k;var n=new Y.Cb({map:t,transparent:!0}),a=new Y.Bb(n);return a.scale.x=.015*e.width,a.scale.y=.015*e.height,a}function fe(e,t,n,a){if(ce[e]){var o=ce[e],i=ae(t,n,a);o.position.set(i.x,i.y,i.z),ve(e,he())}}function pe(e){var t=ue("npc");ce[e]||(ce[e]=t,fe(e,0,-.25,0),R.add(t))}function ye(e){if(ce[e]){var t=ce[e];R.remove(t),delete ce[e]}}var we,ge=!1;function be(e){(ge&&0==e&&ge&&Se(we),ge)||!1!==e&&Ee(e)}function xe(){return ge}function Ee(e){var t;if(ge=!0,we=e,v(e+" is occupying chair"),"me"===e)t=ee;else{if(!ce[e])return void m("Sorry a bad thing happened "+e+" doesnt exist",[ce]);t=ce[e]}ve(e,"\ud83d\ude04\ud83d\ude04\ud83d\ude04\ud83d\ude04\ud83d\ude04\ud83d\ude04\ud83d\ude04\ud83d\ude04\ud83d\ude04");var n=ae(0,-.2,0);t.position.set($.position.x,n.y,$.position.z)}function Se(e){if(ge=!1,we="","me"===e)ee,le();else{if(!ce[e])return void m(e+" tried to unocupy chair but it doesnt exist");ce[e],le("npc")}ve(e,he()),v(e+" is no longer occupying chair")}function Me(e,t){if(!ee)return m("No cursor yet to update"),!1;var n,a=new Y.Jb(.5*-e,-.25,.5*t),o=ae(a.x,a.y,a.z);return"me"==we?(v("I have moved. i am occupying chair"),!se(ee,o)&&(Se("me"),ee.position.set(o.x,o.y,o.z),a)):(v("I have moved. i am not occupying chair"),ve("me",he()),se(ee,o)?(v("I would intersect with chair if i moved there"),xe()?(v("Would collide, not moving"),!1):(Ee("me"),n=ee.position,new Y.Jb(n.x/te.x,n.y/te.y,n.z/te.z))):(ee.position.set(o.x,o.y,o.z),a))}function ze(){W=[F.clientWidth,F.clientHeight],I.aspect=W[0]/W[1],I.updateProjectionMatrix(),B.setSize(W[0],W[1]),_&&R.remove(_),ne(),oe(),function(){var e=ae(.4,.4,0);Z.position.set(e.x,e.y,e.z)}(),ie()}function Oe(){var e=Q.getDelta();e,B.render(R,I),U&&U.update(),requestAnimationFrame(Oe)}var Te=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleDBOccupationChange=function(e){if(e!==a.myKey){be(e);var t=xe();a.setState({chairOccupied:t})}},a.handleMouseMove=function(e){var t=Me(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1);t&&z(t);var n=!!ge&&we;"me"===n?A("chairOccupation",a.myKey):0==n&&A("chairOccupation",!1);var o=xe();a.setState({chairOccupied:o})},a.scrollElem=o.a.createRef(),a.state={scrollPercent:0,chairOccupied:!1},a.myKey="NEWKEY",a.DBCONST="chairRoom/",a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){X(),E(this.DBCONST),this.myKey=M(),k(pe,ye,fe),N("chairOccupation",this.handleDBOccupationChange,!0)}},{key:"componentWillUnmount",value:function(){C(this.myKey)}},{key:"render",value:function(){return o.a.createElement("div",{onClick:this.handleMouseMove},o.a.createElement("div",{className:"container"}," "),o.a.createElement("div",{id:"footer"},o.a.createElement("div",{className:"left"},"an ",this.state.chairOccupied?"occupied":"unoccupied"," chair"),o.a.createElement("div",{className:"right"},"click")))}}]),n}(o.a.Component);function Ce(e,t){void 0==e&&(e=120,t=120),console.log("Creating grass: "+e+" / "+t);var n=[],a=15e3;function o(e,t){return M=e.x*t.w+e.y*t.z-e.z*t.y+e.w*t.x,z=-e.x*t.z+e.y*t.w+e.z*t.x+e.w*t.y,O=e.x*t.y-e.y*t.x+e.z*t.w+e.w*t.z,T=-e.x*t.x-e.y*t.y-e.z*t.z+e.w*t.w,new Y.Kb(M,z,O,T)}(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))&&(a=8e3);var i=function(){var e={};function t(e,t,n){this.x=e,this.y=t,this.z=n}t.prototype.dot2=function(e,t){return this.x*e+this.y*t},t.prototype.dot3=function(e,t,n){return this.x*e+this.y*t+this.z*n};var n=[new t(1,1,0),new t(-1,1,0),new t(1,-1,0),new t(-1,-1,0),new t(1,0,1),new t(-1,0,1),new t(1,0,-1),new t(-1,0,-1),new t(0,1,1),new t(0,-1,1),new t(0,1,-1),new t(0,-1,-1)],a=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],o=new Array(512),i=new Array(512);e.seed=function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t=0;t<256;t++){var r;r=1&t?a[t]^255&e:a[t]^e>>8&255,o[t]=o[t+256]=r,i[t]=i[t+256]=n[r%12]}},e.seed(0);var r=.5*(Math.sqrt(3)-1),s=(3-Math.sqrt(3))/6,c=1/6;function l(e){return e*e*e*(e*(6*e-15)+10)}function u(e,t,n){return(1-n)*e+n*t}return e.simplex2=function(e,t){var n,a,c=(e+t)*r,l=Math.floor(e+c),u=Math.floor(t+c),d=(l+u)*s,h=e-l+d,v=t-u+d;h>v?(n=1,a=0):(n=0,a=1);var m=h-n+s,f=v-a+s,p=h-1+2*s,y=v-1+2*s,w=i[(l&=255)+o[u&=255]],g=i[l+n+o[u+a]],b=i[l+1+o[u+1]],x=.5-h*h-v*v,E=.5-m*m-f*f,S=.5-p*p-y*y;return 70*((x<0?0:(x*=x)*x*w.dot2(h,v))+(E<0?0:(E*=E)*E*g.dot2(m,f))+(S<0?0:(S*=S)*S*b.dot2(p,y)))},e.simplex3=function(e,t,n){var a,r,s,l,u,d,h=(e+t+n)*(1/3),v=Math.floor(e+h),m=Math.floor(t+h),f=Math.floor(n+h),p=(v+m+f)*c,y=e-v+p,w=t-m+p,g=n-f+p;y>=w?w>=g?(a=1,r=0,s=0,l=1,u=1,d=0):y>=g?(a=1,r=0,s=0,l=1,u=0,d=1):(a=0,r=0,s=1,l=1,u=0,d=1):w<g?(a=0,r=0,s=1,l=0,u=1,d=1):y<g?(a=0,r=1,s=0,l=0,u=1,d=1):(a=0,r=1,s=0,l=1,u=1,d=0);var b=y-a+c,x=w-r+c,E=g-s+c,S=y-l+2*c,M=w-u+2*c,z=g-d+2*c,O=y-1+.5,T=w-1+.5,C=g-1+.5,k=i[(v&=255)+o[(m&=255)+o[f&=255]]],N=i[v+a+o[m+r+o[f+s]]],A=i[v+l+o[m+u+o[f+d]]],P=i[v+1+o[m+1+o[f+1]]],D=.6-y*y-w*w-g*g,H=.6-b*b-x*x-E*E,L=.6-S*S-M*M-z*z,j=.6-O*O-T*T-C*C;return 32*((D<0?0:(D*=D)*D*k.dot3(y,w,g))+(H<0?0:(H*=H)*H*N.dot3(b,x,E))+(L<0?0:(L*=L)*L*A.dot3(S,M,z))+(j<0?0:(j*=j)*j*P.dot3(O,T,C)))},e.perlin2=function(e,t){var n=Math.floor(e),a=Math.floor(t);e-=n,t-=a;var r=i[(n&=255)+o[a&=255]].dot2(e,t),s=i[n+o[a+1]].dot2(e,t-1),c=i[n+1+o[a]].dot2(e-1,t),d=i[n+1+o[a+1]].dot2(e-1,t-1),h=l(e);return u(u(r,c,h),u(s,d,h),l(t))},e.perlin3=function(e,t,n){var a=Math.floor(e),r=Math.floor(t),s=Math.floor(n);e-=a,t-=r,n-=s;var c=i[(a&=255)+o[(r&=255)+o[s&=255]]].dot3(e,t,n),d=i[a+o[r+o[s+1]]].dot3(e,t,n-1),h=i[a+o[r+1+o[s]]].dot3(e,t-1,n),v=i[a+o[r+1+o[s+1]]].dot3(e,t-1,n-1),m=i[a+1+o[r+o[s]]].dot3(e-1,t,n),f=i[a+1+o[r+o[s+1]]].dot3(e-1,t,n-1),p=i[a+1+o[r+1+o[s]]].dot3(e-1,t-1,n),y=i[a+1+o[r+1+o[s+1]]].dot3(e-1,t-1,n-1),w=l(e),g=l(t),b=l(n);return u(u(u(c,m,w),u(d,f,w),b),u(u(h,p,w),u(v,y,w),b),g)},e}();function r(e,t){i.simplex2(e/50,t/50);return 4*i.simplex2(e/100,t/100),.2*i.simplex2(e/10,t/10),0,0}i.seed(Math.random());var s=new Y.gb(e,t,32,32);s.lookAt(new Y.Jb(0,1,0)),s.verticesNeedUpdate=!0;new Y.m;for(var c=new Y.Q({color:4369458}),l=new Y.P(s,c),u=0;u<l.geometry.vertices.length;u++){var d=l.geometry.vertices[u];d.y=r(d.x,d.z)}l.geometry.computeVertexNormals(),n.push(l);var h=new Y.fb(.03,.7,1,5);h.translate(0,.35,0);var v=new Y.Q({color:16711680,side:Y.p}),m=(new Y.P(h,v),new Y.w);m.index=h.index,m.attributes.position=h.attributes.position,m.attributes.uv=h.attributes.uv;var f=[],p=[],y=[],w=[],g=[],b=new Y.Kb,x=new Y.Kb;for(u=0;u<a;u++){M=Math.random()*e-e/2,O=Math.random()*t-t/2,z=r(M,O),f.push(M,z,O);var E=Math.PI-Math.random()*(2*Math.PI);w.push(Math.sin(.5*E)),g.push(Math.cos(.5*E));var S=new Y.Jb(0,1,0),M=S.x*Math.sin(E/2),z=S.y*Math.sin(E/2),O=S.z*Math.sin(E/2),T=Math.cos(E/2);b.set(M,z,O,T).normalize(),E=.5*Math.random()-.25,S=new Y.Jb(1,0,0),M=S.x*Math.sin(E/2),z=S.y*Math.sin(E/2),O=S.z*Math.sin(E/2),T=Math.cos(E/2),x.set(M,z,O,T).normalize(),b=o(b,x),E=.5*Math.random()-.25,S=new Y.Jb(0,0,1),M=S.x*Math.sin(E/2),z=S.y*Math.sin(E/2),O=S.z*Math.sin(E/2),T=Math.cos(E/2),x.set(M,z,O,T).normalize(),b=o(b,x),p.push(b.x,b.y,b.z,b.w),u<a/3?y.push(1.8*Math.random()):y.push(Math.random())}var C=new Y.v(new Float32Array(f),3),k=new Y.v(new Float32Array(y),1),N=new Y.v(new Float32Array(w),1),A=new Y.v(new Float32Array(g),1),P=new Y.v(new Float32Array(p),4);m.setAttribute("offset",C),m.setAttribute("orientation",P),m.setAttribute("stretch",k),m.setAttribute("halfRootAngleSin",N),m.setAttribute("halfRootAngleCos",A);var D=new Y.Fb;D.crossOrigin="";var H=D.load("/assets/grass/blade_diffuse_cray.jpg"),L=D.load("/assets/grass/blade_alpha.jpg"),j=new Y.qb({uniforms:{map:{value:H},alphaMap:{value:L},time:{type:"float",value:0},windPos:{type:"vec3",value:new Y.Jb(0,0,0)}},vertexShader:'\nprecision mediump float;\nuniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform vec3 windPos; \nattribute vec3 position;\nattribute vec3 offset;\nattribute vec2 uv;\nattribute vec4 orientation;\nattribute float halfRootAngleSin;\nattribute float halfRootAngleCos;\nattribute float stretch;\nuniform float time;\nvarying vec2 vUv;\nvarying float frc;\n\n//WEBGL-NOISE FROM https://github.com/stegu/webgl-noise\n\n//Description : Array and textureless GLSL 2D simplex noise function. Author : Ian McEwan, Ashima Arts. Maintainer : stegu Lastmod : 20110822 (ijm) License : Copyright (C) 2011 Ashima Arts. All rights reserved. Distributed under the MIT License. See LICENSE file. https://github.com/ashima/webgl-noise https://github.com/stegu/webgl-noise\n\nvec3 mod289(vec3 x) {return x - floor(x * (1.0 / 289.0)) * 289.0;} \nvec2 mod289(vec2 x) {return x - floor(x * (1.0 / 289.0)) * 289.0;} \nvec3 permute(vec3 x) {return mod289(((x*34.0)+1.0)*x);} \nfloat snoise(vec2 v){const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439); vec2 i  = floor(v + dot(v, C.yy) ); vec2 x0 = v -   i + dot(i, C.xx); vec2 i1; i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0); vec4 x12 = x0.xyxy + C.xxzz; x12.xy -= i1; i = mod289(i); vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 )); vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0); m = m*m ; m = m*m ; vec3 x = 2.0 * fract(p * C.www) - 1.0; vec3 h = abs(x) - 0.5; vec3 ox = floor(x + 0.5); vec3 a0 = x - ox; m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h ); vec3 g; g.x  = a0.x  * x0.x  + h.x  * x0.y; g.yz = a0.yz * x12.xz + h.yz * x12.yw; return 130.0 * dot(m, g);}\n//END NOISE\n\n//https://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/\nvec3 rotateVectorByQuaternion( vec3 v, vec4 q){\nreturn 2.0 * cross(q.xyz, v * q.w + cross(q.xyz, v)) + v;\n}\nvec4 vectorToQuaternion(vec3 v){\n    float c1 = cos(v.y / 2.0);\n    float c2 = cos(v.x / 2.0);\n    float c3 = cos(v.z / 2.0);\n    float s1 = sin(v.y / 2.0);\n    float s2 = sin(v.x / 2.0);\n    float s3 = sin(v.z / 2.0);\n\n    float c1c2 = c1 * c2;\n    float s1s2 = s1 * s2;\n\n    float w = c1c2 * c3 - s1s2 * s3;\n    float x = c1c2 * s3 + s1s2 * c3;\n    float y = s1 * c2 * c3 + c1 * s2 * s3;\n    float z = c1 * s2 * c3 - s1 * c2 * s3;\n\n    return vec4(-x, y, z, w);\n}\n\n//https://en.wikipedia.org/wiki/Slerp\nvec4 slerp(vec4 v0, vec4 v1, float t) {\n// Only unit quaternions are valid rotations.\n// Normalize to avoid undefined behavior.\nnormalize(v0);\nnormalize(v1);\n\n// Compute the cosine of the angle between the two vectors.\nfloat dot_ = dot(v0, v1);\n\n// If the dot product is negative, slerp won\'t take\n// the shorter path. Note that v1 and -v1 are equivalent when\n// the negation is applied to all four components. Fix by \n// reversing one quaternion.\nif (dot_ < 0.0) {\nv1 = -v1;\ndot_ = -dot_;\n}  \n\nconst float DOT_THRESHOLD = 0.9995;\nif (dot_ > DOT_THRESHOLD) {\n// If the inputs are too close for comfort, linearly interpolate\n// and normalize the result.\n\nvec4 result = t*(v1 - v0) + v0;\nnormalize(result);\nreturn result;\n}\n\n// Since dot is in range [0, DOT_THRESHOLD], acos is safe\nfloat theta_0 = acos(dot_);       // theta_0 = angle between input vectors\nfloat theta = theta_0*t;          // theta = angle between v0 and result\nfloat sin_theta = sin(theta);     // compute this value only once\nfloat sin_theta_0 = sin(theta_0); // compute this value only once\n\nfloat s0 = cos(theta) - dot_ * sin_theta / sin_theta_0;  // == sin(theta_0 - theta) / sin(theta_0)\nfloat s1 = sin_theta / sin_theta_0;\n\nreturn (s0 * v0) + (s1 * v1);\n}\n\nvoid main() {\n\n//Relative position of vertex along the mesh Y direction\nfrc = position.y/float(0.8);\n\n//Get wind data from simplex noise \n//Note we\'re applying the following equations to every VERTEX, not every BLADE of grass\n\n//Noise returned here is a SINGLE FLOAT that changed depending on the x/z position of the particular blade\n// So i think noise is a range from 1.0 to 0.0\nfloat noise = 1.0-(snoise(vec2(((0.35 * time) - offset.x/10.0), ((0.35 * time) -offset.z/10.0)))); \n\n//STEP 1: RANDOMLY BEND THE GRASS IN SOME DIRECTION\n//Define the direction of an unbent blade of grass rotated around the Y axis\n//WHAT THIS DOES IS RANDOMLY ASIGN A BEND TO THE GRASS\nvec4 direction = vec4(0.0, halfRootAngleSin, 0.0, halfRootAngleCos);\n\n//Interpolate between the unbent direction and the direction of growth calculated on the CPU. \n//Using the relative location of the vertex along the Y axis as the weight, we get a smooth bend\n// WHAT THIS BASICALLY MEANS IS THAT THE TOP MOST VERTEX OF THE GRASS BLADE IS THE MOST BEND, AND THE BOTTOM MOST IS THE LEAST BENT AND THEREFORE THE GRASS IS "SMOOTHLY" BENT\n// IF WE REMOVE THE SLERP WE GET A STRAIGHT BLADE OF GRASS BECAUSE THE "SLERP" IS GONE (THE SMOOTHNESS)\ndirection = slerp(direction, orientation, frc);\nvec3 vPosition = vec3(position.x, position.y + position.y * stretch, position.z);\nvPosition = rotateVectorByQuaternion(vPosition, direction);\n\n//STEP 2: FIGURE OUT THE AFFECT OF THE WIND BUT SCALE IT ACC TO POSITION OF PLAYER\n\n//This gives us the wind \nfloat halfAngle = noise * 0.15;\nvec4 windAngle = normalize(vec4(sin(halfAngle), 0.0, -sin(halfAngle), cos(halfAngle)));\n\n//We remove this line which just applies the wind straight up\n//vPosition = rotateVectorByQuaternion(vPosition, windAngle); \n\n//Instead we figure out the "windPos" (mousePos) and how far I am for it and distort accordingly\nvec3 vObjectPosition = (modelMatrix * vec4( 0.0, 0.0, 0.0, 1.0 )).xyz; \nvec3 windPosVector = windPos - (vObjectPosition + offset); \nvec3 distortionAngle = normalize(vec3(windPosVector.x, 0, windPosVector.z));\nfloat distortionInfluence = clamp(2.0 - length(windPosVector), 0.0, 1.0) * 1.2;\n\n//The the angle thats applied is one that is effected by the distortion influence\nvec4 angle = mix(windAngle, vectorToQuaternion(distortionAngle), pow(distortionInfluence, 2.0));\nvPosition = rotateVectorByQuaternion(vPosition, angle);\n\n//UV for texture\nvUv = uv;\n\n//Calculate final position of the vertex from the world offset and the above shenanigans \ngl_Position = projectionMatrix * modelViewMatrix * vec4(offset + vPosition, 1.0 );\n}',fragmentShader:"\nprecision mediump float;\nuniform sampler2D map;\nuniform sampler2D alphaMap;\nvarying vec2 vUv;\nvarying float frc;\n\nvoid main() {\n//Get transparency information from alpha map\nfloat alpha = texture2D(alphaMap, vUv).r;\n//If transparent, don't draw\nif(alpha < 0.15){\ndiscard;\n}\n//Get colour data from texture\nvec4 col = vec4(texture2D(map, vUv));\n//Add more green towards root\ncol = mix(vec4(0.0, 0.6, 0.2, 1.0), col, frc);\n//Add a shadow towards root\n//col = mix(vec4(0.0, 0.1, 0.0, 1.0), col, frc);\ngl_FragColor = col;\n}",side:Y.p}),I=new Y.P(m,j);return n.push(I),n}var ke,Ne,Ae,Pe,De,He,Le,je=new Y.l;function Ie(){De=document.querySelector(".container"),Pe=[De.clientWidth,De.clientHeight],je.start(),(Ae=new Y.Mb({alpha:!0,antialias:!0})).physicallyCorrectLights=!1,Ae.setSize(Pe[0],Pe[1]),De.appendChild(Ae.domElement),Ne=new Y.tb,ke=new Y.eb(45,Pe[0]/Pe[1],.1,1e3),window.addEventListener("resize",Xe,!1),Ue(),Je(),(Re=new Y.a(16777215,1.5)).color.setHSL(.2,.5,.5),Ne.add(Re),Ke(),Ze()}var Re,Be,We,Fe=new Y.Jb(15,15,15);function Ue(){Fe.y=Fe.x*(Pe[1]/Pe[0]),Fe.z=Math.max(Fe.x,Fe.y)*(Pe[0]>=800?1:2);var e=new Y.f(Fe.x,Fe.y,Fe.z),t=new Y.S({color:"#FFFFFF"});t.side=Y.c,Le=new Y.P(e,t),Ne.add(Le)}function _e(e,t,n){return new Y.Jb(e*Fe.x,t*Fe.y,n*Fe.z)}function Je(){var e=_e(0,-.15,-.6);ke.position.set(e.x,e.y,e.z);var t=_e(0,-.4,0);ke.lookAt(t)}function Ve(){!function(){Be&&Be.forEach((function(e){return Ne.remove(e)}));Ke()}()}var Ge=.7;function Ke(){(Be=Ce(Fe.x,Fe.z)).forEach((function(e,t){var n=_e(0,-.4,0);e.position.set(n.x,n.y,n.z),Be.push=e,Ne.add(e),1===t&&(We=e.material)})),qe(0,0)}function Ye(e){Ge=Math.max(.2,2.3*e),Re.color.setHSL(.2,e-.2,1-e/2)}function qe(e,t){var n=_e(.5*-e,-.46,.5*t);We.uniforms.windPos.value=n}var Qe=0;function Xe(){Pe=[De.clientWidth,De.clientHeight],ke.aspect=Pe[0]/Pe[1],ke.updateProjectionMatrix(),Ae.setSize(Pe[0],Pe[1]),Le&&Ne.remove(Le),Ue(),Je(),Ve()}function Ze(){var e=je.getDelta();(function(e){We&&(We.uniforms.time.value=e*Ge)})(Qe+=e),Ae.render(Ne,ke),He&&He.update(),requestAnimationFrame(Ze)}var $e,et=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleMouseMove=function(e){qe(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1)},a.onDBScrollChange=function(e){if(void 0!=e){v("Scroll moved.. updating room",[e]),Ye(e);var t=a.scrollElem.current,n=e*t.scrollHeight-t.clientHeight;a.scrollElem.current.scrollTop=n}},a.handleScroll=function(e){var t=e.target,n=(t.scrollTop+t.clientHeight)/t.scrollHeight;A("scroll",n),Ye(n)},a.scrollElem=o.a.createRef(),a.DBCONST="grassZone",a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){Ie(),E(this.DBCONST),N("scroll",this.onDBScrollChange,!1)}},{key:"render",value:function(){return o.a.createElement("div",{onClick:this.handleMouseMove,style:{cursor:"crosshair"}},o.a.createElement("div",{className:"container"}," ")," ",o.a.createElement("div",{id:"footer"},o.a.createElement("div",{className:"left"},"movement"),o.a.createElement("div",{className:"right"},"scroll up/down, click"))," ",o.a.createElement("div",{id:"scroll-container",ref:this.scrollElem,onScroll:this.handleScroll},o.a.createElement("div",{id:"scroll-element"}," ")," ")," ")}}]),n}(o.a.Component),tt=n(29),nt=["midnight","sunrise","dawn","midday","lateday","sunset","twilight"],at=[],ot=!1;function it(e){void 0!=e&&(ot=e);for(var t=0;t<5;t++){for(var n=[],a=0;a<nt.length;a++){var o=lt(bt[nt[a]][t]);n.push(o)}var i=tt(n);at.push(i),ot&&ct(i,"sky-gradient-pos"+t)}console.log(at);for(var r=[],s=0;s<nt.length;s++){var c=lt(xt[nt[s]]);r.push(c)}console.log(r),$e=tt(r),ot&&ct($e,"ambient"),ot&&function(){for(var e=[],t=0;t<=1;t+=.25){var n=lt([100,0,100*ut(t)]);e.push(n)}ct(tt(e),"ambient-intensity")}()}var rt,st=1;function ct(e,t){var n=document.createElement("div");void 0==t&&(t=""),n.innerHTML=t,n.id="gradient-test"+st,n.style.position="absolute",n.style.top=0,n.style.left="".concat(10*st,"%"),n.style.width="3%",n.style.height="10%",n.style.zIndex=500;var a=[e(0),e(.25),e(.5),e(.75),e(1)],o="linear-gradient(to bottom, ".concat(a[0]," 0%, ").concat(a[1]," 25%, ").concat(a[2]," 50%, ").concat(a[3]," 75%, ").concat(a[4]," 100%)");n.style.backgroundImage=o,document.body.appendChild(n),st+=1}function lt(e){return 3!=e.length?void alert("Error in color conversion"):"hsl(".concat(e[0],", ").concat(e[1],"%, ").concat(e[2],"%)")}function ut(e){var t,n,a,o,i=e;return t=-6.106227*Math.pow(Math.E,-16)+5.35918*i+-8.07754*Math.pow(i,2)+2.71836*Math.pow(i,3),a=0,t=(n=t)>(o=1.2)?o:n<a?a:n,ot&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";void 0==rt&&((rt=document.createElement("div")).id="ambient-debug",rt.style.position="absolute",rt.style.top=0,rt.style.right=0,rt.style.width="10%",rt.style.height="10%",rt.style.zIndex=500,document.body.appendChild(rt)),rt.innerHTML="ambientintensity <br/>"+e+" <br/> with percent <br/>"+t,rt.style.backgroundColor="hsl(100, 0%, ".concat(100*e,"%)"),rt.style.color="hsl(100, 0%, ".concat(100*(1-e),"%)")}(t,e),t}var dt,ht,vt,mt,ft,pt,yt,wt,gt,bt={midnight:[[247,74,10],[259,78,20],[244,63,32],[241,60,43],[241,65,57]],sunrise:[[221,82,26],[204,100,57],[194,100,82],[190,36,78],[241,13,78]],dawn:[[212,83,76],[200,73,79],[194,73,82],[193,45,82],[193,22,81]],midday:[[193,89,80],[193,89,80],[193,89,80],[193,75,80],[193,59,80]],lateday:[[200,70,60],[200,70,60],[200,70,60],[200,70,60],[200,70,60]],sunset:[[203,75,79],[197,55,89],[197,55,89],[345,80,89],[29,98,62]],twilight:[[229,69,33],[240,65,33],[231,64,33],[235,59,61],[230,51,67]]},xt={midnight:[248,65,54],sunrise:[217,54,69],dawn:[198,67,91],midday:[193,89,90],lateday:[200,70,88],sunset:[29,98,62],twilight:[230,51,67]},Et=new Y.l;function St(){ft=document.querySelector(".container"),mt=[ft.clientWidth,ft.clientHeight],Et.start(),(vt=new Y.Mb({alpha:!0,antialias:!0})).physicallyCorrectLights=!0,vt.setSize(mt[0],mt[1]),vt.shadowMap.enabled=!0,ft.prepend(vt.domElement),ht=new Y.tb,dt=new Y.eb(45,mt[0]/mt[1],.1,1e3),window.addEventListener("resize",It,!1),it(!1),Nt(),Mt(),function(){var e=new q.a;e.load("/assets/plant/UmbrellaPalmTree.gltf",(function(e){(Ct=e.scene).traverse((function(e){e.isMesh&&(e.castShadow=!0,e.material.clone(),e.material.metalness=.2,e.material.color.setRGB(1,1,1))})),Lt(),ht.add(Ct)}))}(),function(){Ot=At(.3,.5,1),(zt=new Y.n(16776960,1.5)).color.setHSL(.2,1,.4),zt.position.set(Ot.x,Ot.y,Ot.z),zt.castShadow=!0,zt.shadow.radius=2,zt.shadow.mapSize.width=2048,zt.shadow.mapSize.height=2048,ht.add(zt);var e=Pt();zt.target.position.set(e.x,e.y,e.z),zt.target.updateMatrixWorld(),ht.add(zt.target);var t=At(1,1,2);zt.shadow.camera.left=-t.x,zt.shadow.camera.right=t.x,zt.shadow.camera.top=t.y,zt.shadow.camera.bottom=-t.y,zt.shadow.camera.far=2*t.z,zt.shadow.camera.updateProjectionMatrix()}(),Tt=new Y.a(16777215,2),ht.add(Tt),jt(0),Rt()}function Mt(){var e=At(0,.1,-2);dt.position.set(e.x,e.y,e.z);var t=At(0,-.1,.5);dt.lookAt(t)}var zt,Ot,Tt,Ct,kt=new Y.Jb(15,15,15);function Nt(){kt.y=kt.x*(mt[1]/mt[0]),kt.z=kt.y;var e=new Y.f(kt.x,kt.y,kt.z),t=new Y.Q({color:0,wireframe:!0});(yt=new Y.P(e,t)).receiveShadow=!0;var n=At(1,0,1),a=At(0,-.5,0),o=new Y.gb(n.x,n.z,20,20),i=new Y.S({color:16777215,emissive:0});i.side=Y.p,(wt=new Y.P(o,i)).rotation.x=Math.PI/2,wt.position.set(a.x,a.y,a.z),wt.receiveShadow=!0,ht.add(wt);var r=At(1,1,0),s=At(0,0,.5),c=new Y.fb(r.x,r.y,20,20),l=new Y.Fb,u=new Y.S({alphaMap:l.load("/assets/textures/roomWindow-split.png"),transparent:!0,color:16777215,emissive:0});u.side=Y.c,gt=new Y.P(c,u);var d=new Y.R({depthPacking:Y.nb,alphaMap:l.load("/assets/textures/roomWindow-split.png"),alphaTest:.5});gt.customDepthMaterial=d,gt.position.set(s.x,s.y,s.z),gt.castShadow=!0,ht.add(gt)}function At(e,t,n){return new Y.Jb(e*kt.x,t*kt.y,n*kt.z)}function Pt(){return Ct?Ct.position.clone():new Y.Jb(0,0,0)}function Dt(){zt.position.set(Ot.x,Ot.y,Ot.z);var e=Pt();zt.target.position.set(e.x,e.y,e.z),zt.target.updateMatrixWorld()}function Ht(){Ct&&Lt()}function Lt(){var e=At(.1,.5,.1),t=At(0,-.3,.45),n=(new Y.e).setFromObject(Ct),a=n.getCenter(new Y.Jb),o=n.getSize(new Y.Jb),i=o.y,r=e.y;Ct.scale.multiplyScalar(r/i),n.setFromObject(Ct),n.getCenter(a),n.getSize(o),Ct.position.copy(a).multiplyScalar(-1),Ct.position.set(t.x,t.y,t.z-e.z/2)}function jt(e){e=Math.min(1,e);var t=At((e=Math.max(0,e))-.5,0,0);Ot.x=t.x,Dt();var n=new Y.m(function(e){var t=$e(e);return console.log(t),t}(e));zt.color=n,Tt.color=n,Tt.intensity=3.5*ut(e);var a=document.getElementById("sunroom-container"),o=function(e){for(var t=[],n=0;n<5;n++){var a=at[n](e);t.push(a)}return function(e){return"linear-gradient(to bottom, ".concat(e[0]," 0%, ").concat(e[1]," 25%, ").concat(e[2]," 50%, ").concat(e[3]," 75%, ").concat(e[4]," 100%)")}(t)}(e);a.style.backgroundImage=o;var i=e*Math.PI;Ct&&(Ct.rotation.y=i)}function It(){mt=[ft.clientWidth,ft.clientHeight],dt.aspect=mt[0]/mt[1],dt.updateProjectionMatrix(),vt.setSize(mt[0],mt[1]),yt&&(ht.remove(yt),ht.remove(wt),ht.remove(gt)),Nt(),Mt(),Dt(),Ht()}function Rt(){var e=Et.getDelta();e,vt.render(ht,dt),pt&&pt.update(),requestAnimationFrame(Rt)}var Bt,Wt,Ft,Ut,_t,Jt,Vt,Gt=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onDBScrollChange=function(e){if(void 0!==e&&e!==a.state.scrollPercent){jt(e);var t=.8*e+.2,n=a.scrollElem.current,o=t*n.scrollHeight-n.clientHeight;a.scrollElem.current.scrollTop=o}},a.handleScroll=function(e){var t=e.target,n=((t.scrollTop+t.clientHeight)/t.scrollHeight-.2)/.8;a.setState({scrollP:n}),v("Scroll updated "+n),jt(n),A("scroll",n)},a.scrollElem=o.a.createRef(),a.simulatedSunPercent=0,a.fgElem=o.a.createRef(),a.state={scrollPercent:0},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){St(),E("sunRoom"),N("scroll",this.onDBScrollChange,!1)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"container",id:"sunroom-container"},o.a.createElement("div",{id:"canvas-foreground",style:{width:"600%",height:"100%",flexDirection:"row",left:500*-this.state.scrollP+"%",top:"-100%",opacity:"0.8"}},o.a.createElement("div",{className:"fg-img",style:{backgroundImage:"url(/assets/sky/29-star.png)",backgroundRepeat:"round",backgroundSize:"29% auto"}}),o.a.createElement("div",{className:"fg-img",style:{backgroundImage:"url(/assets/sky/29-star.png), url(/assets/sky/V2/CLOUD-CIRRUS.png) ",backgroundRepeat:"repeat, no-repeat",backgroundSize:"29% auto, contain"}}),o.a.createElement("div",{className:"fg-img",style:{backgroundImage:"url(/assets/sky/V2/29-cloud.png), url(/assets/sky/V2/CLOUD-CUMULO.png)",backgroundRepeat:"no-repeat, no-repeat",backgroundSize:"20% auto, contain",backgroundPosition:"right, center"}}),o.a.createElement("div",{className:"fg-img",style:{backgroundImage:"url(/assets/sky/V2/CLOUD-CIRRUS.png)",backgroundRepeat:"no-repeat",backgroundSize:"50%",backgroundPosition:"top"}}),o.a.createElement("div",{className:"fg-img"}),o.a.createElement("div",{className:"fg-img",style:{backgroundImage:"url(/assets/sky/29-star.png)",backgroundRepeat:"round",backgroundSize:"29% auto"}}))),o.a.createElement("div",{id:"footer"}," ",o.a.createElement("div",{id:"footer"},o.a.createElement("div",{className:"left"},"time "),o.a.createElement("div",{className:"right"},"scroll up/down"))," "),o.a.createElement("div",{id:"scroll-container",ref:this.scrollElem,onScroll:this.handleScroll},o.a.createElement("div",{id:"scroll-element"}," ")))}},{key:"simulateSunMove",value:function(){var e=this;this.simulatedSunPercent+=.05,this.simulatedSunPercent>=1&&(this.simulatedSunPercent=0),jt(this.simulatedSunPercent),setTimeout((function(){return e.simulateSunMove()}),500)}}]),n}(o.a.Component),Kt=new Y.l;function Yt(){_t=document.querySelector(".container"),Ut=[_t.clientWidth,_t.clientHeight],Kt.start(),(Ft=new Y.Mb({alpha:!0,antialias:!0})).physicallyCorrectLights=!0,Ft.setSize(Ut[0],Ut[1]),Ft.outputEncoding=Y.Nb,Ft.toneMapping=Y.rb,_t.appendChild(Ft.domElement),Wt=new Y.tb,Bt=new Y.eb(45,Ut[0]/Ut[1],.1,1e3),window.addEventListener("resize",dn,!1),Xt(),$t(),un(),qt=an(),Wt.add(qt),rn(.5,.5),on("me",0,0),hn()}var qt,Qt=new Y.Jb(15,15,15);function Xt(){Qt.y=Qt.x*(Ut[1]/Ut[0]),Qt.z=Math.max(Qt.x,Qt.y)*(Ut[0]>=800?1.5:2);var e=new Y.f(Qt.x,Qt.y,Qt.z),t=new Y.W({roughness:10,metalness:.2,color:"#fff"});t.side=Y.c,Vt=new Y.P(e,t),Wt.add(Vt)}function Zt(e,t,n){return new Y.Jb(e*Qt.x,t*Qt.y,n*Qt.z)}function $t(){var e=Zt(0,0,-.9);Bt.position.set(e.x,e.y,e.z);var t=Zt(0,0,0);Bt.lookAt(t)}function en(){!function(){tn&&Wt.remove(tn);un()}()}var tn,nn={};function an(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=new Y.u,n=new Y.hb(16777215,7,100,2);n.castShadow=!0,t.add(n);var a=16777215;"npc"===e&&(a=14342874);var o=Zt(.005,.005,.005),i=new Y.yb(o.z,16,16),r=new Y.Q({color:a,transparent:.2,opacity:1}),s=new Y.P(i,r);return t.add(s),t}function on(e,t,n){var a;if("me"===e)a=qt;else{if(!nn[e])return m(e+" wasn't found, cant update its light"),void console.log(nn);a=nn[e]}console.log("Setting new light");var o=1-n,i=.7-.7*t,r=1-o/2;return a.traverse((function(e){e.isLight&&e.color.setHSL(i,o,r),e.isMesh&&e.material.color.setHSL(i,o,r)})),{hue:t,saturation:n}}function rn(e,t){if(qt){var n=new Y.Jb(.5*-e,.5*t,.5*t),a=Zt(n.x,n.y,n.z);return qt.position.set(a.x,a.y,a.z),n}}function sn(e,t,n,a){if(nn[e]){var o=nn[e],i=Zt(t,n,a);o.position.set(i.x,i.y,i.z)}}function cn(e){var t=an("npc");nn[e]||(nn[e]=t,sn(e,0,0,0),console.log(nn),Wt.add(t))}function ln(e){if(nn[e]){var t=nn[e];Wt.remove(t),delete nn[e]}}function un(){var e=Zt(0,0,0),t=Zt(0,.02,0).y,n=new Y.xb(t,16,16),a=new Y.W({roughness:0,metalness:1,color:"white",envMap:Bt.renderTarget});(tn=new Y.P(n,a)).position.set(e.x,-e.y,e.z),Wt.add(tn)}function dn(){Ut=[_t.clientWidth,_t.clientHeight],Bt.aspect=Ut[0]/Ut[1],Bt.updateProjectionMatrix(),Ft.setSize(Ut[0],Ut[1]),Vt&&Wt.remove(Vt),Xt(),$t(),en()}function hn(){var e=Kt.getDelta();e,Ft.render(Wt,Bt),Jt&&Jt.update(),requestAnimationFrame(hn)}var vn,mn,fn,pn,yn,wn,gn,bn,xn,En,Sn,Mn,zn,On=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleMouseMove=function(e){z(rn(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1))},a.updateNPCLight=function(e,t){on(e,t.hue,t.saturation)},a.handleScroll=function(e,t){var n=e.target,a=on("me",((n.scrollTop+n.clientHeight)/n.scrollHeight-.2)/.8,((n.scrollLeft+n.clientWidth)/n.scrollWidth-.2)/.8);O("light",{hue:a.hue,saturation:a.saturation})},a.scrollElem=o.a.createRef(),a.DBCONST="lightRoom",a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){Yt(),E(this.DBCONST),this.myKey=M(),k(cn,ln,sn,{light:this.updateNPCLight});var e=on("me",0,0);O("light",{hue:e.hue,saturation:e.saturation})}},{key:"componentWillUnmount",value:function(){C(this.myKey)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{cursor:"none"},onMouseMove:this.handleMouseMove,onClick:function(t){K.isMobile&&e.handleMouseMove(t)}},o.a.createElement("div",{className:"container"}," "),o.a.createElement("div",{id:"footer"},o.a.createElement("div",{className:"left"},"visibility"),o.a.createElement("div",{className:"right"},!K.isMobile&&"move mouse"," ",K.isMobile&&"click",", scroll left/right")),o.a.createElement("div",{id:"scroll-container",className:"horizontal",ref:this.scrollElem,onScroll:this.handleScroll},o.a.createElement("div",{id:"scroll-element"}," ")," ")," ")}}]),n}(o.a.Component),Tn=n(11),Cn=n.n(Tn),kn=Cn.a.Engine,Nn=Cn.a.Render,An=Cn.a.World,Pn=Cn.a.Bodies,Dn=Cn.a.Body,Hn=Cn.a.Mouse,Ln=Cn.a.MouseConstraint;Cn.a.Composite;function jn(){vn=kn.create(),mn=document.getElementById("trashroom-container"),(fn=Nn.create({element:mn,engine:vn,options:{wireframes:!1}})).canvas.width=mn.clientWidth,fn.canvas.height=mn.clientHeight,function(){En=Cn.a.Vector.create(Rn(1,.1).x,50);var e=Rn(.5,1,0,27);yn=Pn.rectangle(e.x,e.y,En.x,En.y,{isStatic:!0});var t=Rn(.5,0,0,-26);bn=Pn.rectangle(t.x,t.y,En.x,En.y,{isStatic:!0}),Sn=Cn.a.Vector.create(50,Rn(.1,1).y);var n=Rn(0,.5,-26,0);wn=Pn.rectangle(n.x,n.y,Sn.x,Sn.y,{isStatic:!0});var a=Rn(1,.5,26,0);gn=Pn.rectangle(a.x,a.y,Sn.x,Sn.y,{isStatic:!0})}(),function(){var e=Rn(.8,.15);(xn=Pn.circle(e.x,e.y,80,{isStatic:!0,render:{fillStyle:"white"}})).id="TRASHCAN",An.add(vn.world,[xn])}(),zn=Hn.create(fn.canvas),Mn=Ln.create(vn,{mouse:zn,constraint:{stiffness:.2,render:{visible:!1}}}),pn=vn.world,An.add(pn,Mn),fn.mouse=zn,An.add(pn,[yn,bn,wn,gn]),kn.run(vn),Nn.run(fn)}function In(){return Math.floor(30*Math.random())}function Rn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=fn.canvas.width,i=fn.canvas.height,r=e*o,s=t*i;r+=n,s+=a;var c=Cn.a.Vector.create(r,s);return c}function Bn(){fn.canvas.width=mn.clientWidth,fn.canvas.height=mn.clientHeight;var e=Rn(.5,1);e=Cn.a.Vector.create(e.x,e.y+25+1);var t=Rn(1,.1),n=t.x/En.x;Dn.scale(yn,n,1),Dn.setPosition(yn,e),En=t}var Wn=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onTrashCollidedWithTrashCan=function(e){console.log(e);var t=g.ref(a.DBCONST),n=e.id;t.child(n).remove()},a.generateNewTrash=function(){if(j()){console.log("Generating trash...");a.state.trashObjects;var e=a.state.mouseX,t=a.state.mouseY;if(a.state.numTrash<150){var n=g.ref(a.DBCONST).push().key,o={left:e,top:t},i={};i[a.DBCONST+"/"+n]=o,g.ref().update(i)}else console.log("Hidden, no trash generated")}},a.cycleTrash=function(){a.generateNewTrash(),setTimeout((function(){return a.cycleTrash()}),1e4)},a.handleMouseMove=function(e){var t=e.clientX/window.innerWidth,n=e.clientY/window.innerHeight;a.setState({mouseX:t,mouseY:n}),a.totalMove+=1,a.totalMove>=250&&(a.totalMove=0,a.generateNewTrash())},a.talkToDatabase=function(){var e=g.ref(a.DBCONST);e.on("child_added",(function(e){var t=e.key,n=e.val(),o=n.left,i=n.top;a.setState({numTrash:a.state.numTrash+1}),function(e,t,n){var a=Rn(t,n),o=Math.floor(5*Math.random()+3),i=Pn.polygon(a.x,a.y,o,50,{render:{fillStyle:"#191920",strokeStyle:"white",lineWidth:2},chamfer:{radius:[In(),In(),In(),In()]}});i.id=e,An.add(vn.world,[i])}(t,o,i)})),e.on("child_removed",(function(e){var t=e.key;a.setState({numTrash:a.state.numTrash-1}),function(e){var t=Cn.a.Composite.get(pn,e,"body");null!=t?Cn.a.Composite.remove(pn,t):m("That body "+e+" doesnt exist",[pn])}(t)}))},a.dbRef="trashRoom",a.totalMove=0,a.state={numTrash:0,mouseX:.5,mouseY:.5,isDown:!1},a.DBCONST="trashRoom",a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e;jn(),this.talkToDatabase(),this.cycleTrash(),window.addEventListener("resize",Bn),e=this.onTrashCollidedWithTrashCan,Cn.a.Events.on(vn,"collisionStart",(function(t){var n=t.pairs[0].bodyA,a=t.pairs[0].bodyB;"TRASHCAN"!==n.id&&"TRASHCAN"!==a.id||(n.id,e(n))}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",Bn)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{onMouseMove:this.handleMouseMove,style:{cursor:this.state.isDown?"grabbing":"grab"},onMouseDown:function(){e.setState({isDown:!0})},onMouseUp:function(){e.setState({isDown:!1})}},o.a.createElement("div",{className:"container",id:"trashroom-container"}),o.a.createElement("div",{id:"footer"},o.a.createElement("div",{className:"left"},"responsibility over ",this.state.numTrash," trash"," "),o.a.createElement("div",{className:"right"},"move, drag")))}}]),n}(o.a.Component),Fn=n(38),Un=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"container"},o.a.createElement(Fn.a,{url:"https://docs.google.com/presentation/d/1X4FTXOlyZ_B-3oaL8EmiJ5CNh-nX_CJTxJDIpH3ro2E/edit",width:"100%",height:"100%",id:"journalIframe",className:"myClassname",display:"initial",position:"relative"})),o.a.createElement("div",{id:"footer"},o.a.createElement("div",{className:"left"},"this page is a shared space about this shared space"),o.a.createElement("div",{className:"right"})))}}]),n}(o.a.Component);r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s.a,null,o.a.createElement(c.c,null,o.a.createElement(c.a,{path:"/smile",component:J})," ",o.a.createElement(c.a,{path:"/grass",component:et})," ",o.a.createElement(c.a,{path:"/sun",component:Gt})," ",o.a.createElement(c.a,{path:"/chair",component:Te})," ",o.a.createElement(c.a,{path:"/light",component:On})," ",o.a.createElement(c.a,{path:"/trash",component:Wn})," ",o.a.createElement(c.a,{path:"/about",component:Un})," ",o.a.createElement(c.a,{path:"/about",component:Un})," ",o.a.createElement(c.a,{path:"/",exact:!0,component:D})," ")," ")," "),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[39,1,2]]]);
//# sourceMappingURL=main.43c1f498.chunk.js.map